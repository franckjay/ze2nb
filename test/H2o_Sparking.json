{"paragraphs":[{"text":"%pyspark\nsc.version","user":"anonymous","dateUpdated":"2019-02-15T13:33:10-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"'2.4.0'\n"}]},"apps":[],"jobName":"paragraph_1549514135807_1384539389","id":"20190206-223535_583137471","dateCreated":"2019-02-06T22:35:35-0600","dateStarted":"2019-02-15T13:33:10-0600","dateFinished":"2019-02-15T13:33:10-0600","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:22181"},{"text":"%pyspark\nsc.addPyFile(\"/Users/dt216661/sparkling-water-2.4.5/py/build/dist/h2o_pysparkling_2.4-2.4.5.zip\")","user":"anonymous","dateUpdated":"2019-02-15T13:33:10-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1549517128858_1985280209","id":"20190206-232528_1247639543","dateCreated":"2019-02-06T23:25:28-0600","dateStarted":"2019-02-15T13:33:10-0600","dateFinished":"2019-02-15T13:33:10-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:22182"},{"text":"%pyspark\nimport h2o\nfrom pysparkling import H2OContext\nh2o.__version__\nhc = H2OContext.getOrCreate(spark)\nprint(hc)","user":"anonymous","dateUpdated":"2019-02-15T13:33:10-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nSparkling Water Context:\n * H2O name: sparkling-water-dt216661_local-1550168119565\n * cluster size: 1\n * list of used nodes:\n  (executorId, host, port)\n  ------------------------\n  (driver,192.168.0.102,54321)\n  ------------------------\n\n  Open H2O Flow in browser: http://192.168.0.102:54321 (CMD + click in Mac OSX)\n\n    \n\nSparkling Water Context:\n * H2O name: sparkling-water-dt216661_local-1550168119565\n * cluster size: 1\n * list of used nodes:\n  (executorId, host, port)\n  ------------------------\n  (driver,192.168.0.102,54321)\n  ------------------------\n\n  Open H2O Flow in browser: http://192.168.0.102:54321 (CMD + click in Mac OSX)\n\n    \n"}]},"apps":[],"jobName":"paragraph_1549514178306_848305874","id":"20190206-223618_1200098002","dateCreated":"2019-02-06T22:36:18-0600","dateStarted":"2019-02-15T13:33:10-0600","dateFinished":"2019-02-15T13:33:10-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:22183"},{"text":"%md\n# 1.Start H2O cluster inside the Spark environment","user":"anonymous","dateUpdated":"2019-02-15T13:33:10-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1550259064069_874384528","id":"20190215-133104_1114429580","dateCreated":"2019-02-15T13:31:04-0600","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:23378","dateFinished":"2019-02-15T13:33:10-0600","dateStarted":"2019-02-15T13:33:10-0600","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>1.Start H2O cluster inside the Spark environment</h1>\n</div>"}]}},{"text":"%pyspark\nfrom pysparkling import *\nhc = H2OContext.getOrCreate(spark)","user":"anonymous","dateUpdated":"2019-02-15T13:33:10-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nSparkling Water Context:\n * H2O name: sparkling-water-dt216661_local-1550168119565\n * cluster size: 1\n * list of used nodes:\n  (executorId, host, port)\n  ------------------------\n  (driver,192.168.0.102,54321)\n  ------------------------\n\n  Open H2O Flow in browser: http://192.168.0.102:54321 (CMD + click in Mac OSX)\n\n    \n"}]},"apps":[],"jobName":"paragraph_1549514188614_107026205","id":"20190206-223628_192889183","dateCreated":"2019-02-06T22:36:28-0600","dateStarted":"2019-02-15T13:33:10-0600","dateFinished":"2019-02-15T13:33:10-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:22184"},{"text":"%md\n# 2. Parse the data using H2O and convert them to Spark Frame","user":"anonymous","dateUpdated":"2019-02-15T13:33:10-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1550259099055_646918113","id":"20190215-133139_16651326","dateCreated":"2019-02-15T13:31:39-0600","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:23471","dateFinished":"2019-02-15T13:33:10-0600","dateStarted":"2019-02-15T13:33:10-0600","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>2. Parse the data using H2O and convert them to Spark Frame</h1>\n</div>"}]}},{"text":"%pyspark\nimport h2o\nframe = h2o.import_file(\"https://raw.githubusercontent.com/h2oai/sparkling-water/master/examples/smalldata/prostate/prostate.csv\")\nspark_frame = hc.as_spark_frame(frame)","user":"anonymous","dateUpdated":"2019-02-15T13:33:10-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Parse progress: |█████████████████████████████████████████████████████████| 100%\n"}]},"apps":[],"jobName":"paragraph_1549516175769_821825720","id":"20190206-230935_1365085414","dateCreated":"2019-02-06T23:09:35-0600","dateStarted":"2019-02-15T13:33:10-0600","dateFinished":"2019-02-15T13:33:11-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:22185"},{"text":"%pyspark\nspark_frame.show(4)\n","user":"anonymous","dateUpdated":"2019-02-15T13:33:11-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1549516191962_1274721374","id":"20190206-230951_1122792245","dateCreated":"2019-02-06T23:09:51-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:22186","dateFinished":"2019-02-15T13:33:11-0600","dateStarted":"2019-02-15T13:33:11-0600","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+-------+---+----+-----+-----+----+----+-------+\n| ID|CAPSULE|AGE|RACE|DPROS|DCAPS| PSA| VOL|GLEASON|\n+---+-------+---+----+-----+-----+----+----+-------+\n|  1|      0| 65|   1|    2|    1| 1.4| 0.0|      6|\n|  2|      0| 72|   1|    3|    2| 6.7| 0.0|      7|\n|  3|      0| 70|   1|    1|    2| 4.9| 0.0|      6|\n|  4|      0| 76|   2|    2|    1|51.2|20.0|      7|\n+---+-------+---+----+-----+-----+----+----+-------+\nonly showing top 4 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.0.102:4040/jobs/job?id=111"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\nspark_frame.describe()","user":"anonymous","dateUpdated":"2019-02-15T13:33:11-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1550258951048_-2035709712","id":"20190215-132911_1377892585","dateCreated":"2019-02-15T13:29:11-0600","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:22824","dateFinished":"2019-02-15T13:33:11-0600","dateStarted":"2019-02-15T13:33:11-0600","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"DataFrame[summary: string, ID: string, CAPSULE: string, AGE: string, RACE: string, DPROS: string, DCAPS: string, PSA: string, VOL: string, GLEASON: string]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.0.102:4040/jobs/job?id=112"],"interpreterSettingId":"spark"}}},{"text":"%md\n# 3. Train the model","user":"anonymous","dateUpdated":"2019-02-15T13:33:11-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1550259137552_-1483672650","id":"20190215-133217_10040558","dateCreated":"2019-02-15T13:32:17-0600","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:23564","dateFinished":"2019-02-15T13:33:11-0600","dateStarted":"2019-02-15T13:33:11-0600","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>3. Train the model</h1>\n</div>"}]}},{"text":"%pyspark\nfrom pysparkling.ml import H2OXGBoost\nestimator = H2OXGBoost(predictionCol=\"AGE\")\nmodel = estimator.fit(spark_frame)\n","user":"anonymous","dateUpdated":"2019-02-15T13:33:12-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1550258967012_-202270814","id":"20190215-132927_1065278727","dateCreated":"2019-02-15T13:29:27-0600","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:22940","dateFinished":"2019-02-15T13:33:12-0600","dateStarted":"2019-02-15T13:33:12-0600","results":{"code":"SUCCESS","msg":[]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.0.102:4040/jobs/job?id=113"],"interpreterSettingId":"spark"}}},{"text":"%md\n# 4. Run Predictions","user":"anonymous","dateUpdated":"2019-02-15T13:33:12-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1550259171343_892880906","id":"20190215-133251_1943162612","dateCreated":"2019-02-15T13:32:51-0600","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:23736","dateFinished":"2019-02-15T13:33:12-0600","dateStarted":"2019-02-15T13:33:12-0600","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>4. Run Predictions</h1>\n</div>"}]}},{"text":"%pyspark\npredictions = model.transform(spark_frame)","user":"anonymous","dateUpdated":"2019-02-15T13:33:13-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1550258991924_-926503294","id":"20190215-132951_1246066292","dateCreated":"2019-02-15T13:29:51-0600","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:23075","dateFinished":"2019-02-15T13:33:13-0600","dateStarted":"2019-02-15T13:33:13-0600","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\npredictions.show(4)","user":"anonymous","dateUpdated":"2019-02-15T13:33:13-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1550259008169_420533","id":"20190215-133008_1517087708","dateCreated":"2019-02-15T13:30:08-0600","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:23178","dateFinished":"2019-02-15T13:33:13-0600","dateStarted":"2019-02-15T13:33:13-0600","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+-------+---+----+-----+-----+----+----+-------+-------------------+\n| ID|CAPSULE|AGE|RACE|DPROS|DCAPS| PSA| VOL|GLEASON|  prediction_output|\n+---+-------+---+----+-----+-----+----+----+-------+-------------------+\n|  1|      0| 65|   1|    2|    1| 1.4| 0.0|      6|[64.85852813720703]|\n|  2|      0| 72|   1|    3|    2| 6.7| 0.0|      7| [72.0611801147461]|\n|  3|      0| 70|   1|    1|    2| 4.9| 0.0|      6|[70.26496887207031]|\n|  4|      0| 76|   2|    2|    1|51.2|20.0|      7|[75.26521301269531]|\n+---+-------+---+----+-----+-----+----+----+-------+-------------------+\nonly showing top 4 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.0.102:4040/jobs/job?id=114"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2019-02-15T13:33:13-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1550259022434_-295318500","id":"20190215-133022_374090086","dateCreated":"2019-02-15T13:30:22-0600","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:23262"}],"name":"H2o_Sparking","id":"2E5151CV6","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}